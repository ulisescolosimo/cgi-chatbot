<div class="flex bg-gray-50 relative min-h-screen">  
  <div class="md:hidden fixed inset-0 bg-black bg-opacity-50 z-40" 
       *ngIf="sidebarExpanded" 
       (click)="toggleSidebar()"></div>  
  
  <app-chatbot-sidebar
    [sidebarExpanded]="sidebarExpanded"
    [healthProfileEnabled]="healthProfileEnabled"
    (toggleSidebar)="toggleSidebar()"
    (clearHistory)="clearHistory()"
    (healthProfileToggled)="onHealthProfileToggle($event)">
  </app-chatbot-sidebar>

  <div class="flex-1 flex flex-col relative w-full mt-0 md:mt-4" 
       style="background-image: url('assets/home/background.png'); background-size: cover; background-position: center; background-repeat: no-repeat;">
        
    <div class="absolute inset-0 bg-white bg-opacity-40 pointer-events-none"></div>

    <button (click)="toggleSidebar()" 
            class="hidden md:flex w-7 h-7 bg-white border border-gray-300 rounded-lg items-center justify-center shadow-md hover:bg-gray-50 cursor-pointer transition-all duration-300 sticky top-3 z-20 mb-3 ml-3"
            [attr.title]="'CHAT.TOGGLE_SIDEBAR' | translate">
      <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
    </button>
    
    <button (click)="toggleSidebar()" 
            class="md:hidden w-7 h-7 bg-white border border-gray-300 rounded-lg flex items-center justify-center shadow-md hover:bg-gray-50 cursor-pointer transition-colors fixed top-3 left-3 z-20"
            *ngIf="!sidebarExpanded"
            [attr.title]="'CHAT.OPEN_MENU' | translate">
      <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
    </button>

    <div class="flex-1 flex flex-col relative z-10 min-h-0">        
     
      <app-chatbot-welcome
        (suggestedQuestion)="onSuggestedQuestionClick($event)"
        *ngIf="messages.length === 0">
      </app-chatbot-welcome>

      <app-chatbot-messages 
        [messages]="messages"
        *ngIf="messages.length > 0">
      </app-chatbot-messages>
      
    </div>

    <app-chatbot-input
      [newMessage]="newMessage"
      [showQuickSuggestions]="messages.length > 0"
      (inputChange)="onInputChange($event)"
      (sendMessage)="send()"
      (quickSuggestion)="onQuickSuggestionClick($event)">
    </app-chatbot-input>
 
    <div class="text-center pb-2 px-4 relative z-10">
      <span class="text-xs text-gray-500" [class.text-green-500]="connectionStatus === ('CHAT.CONNECTED' | translate)" 
            [class.text-red-500]="connectionStatus === ('CHAT.DISCONNECTED' | translate)">
        {{ connectionStatus }}
      </span>
    </div>
  </div>
</div>